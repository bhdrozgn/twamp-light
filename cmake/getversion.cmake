file (STRINGS "VERSION.txt" VERSION_TXT)

execute_process(COMMAND git log -1 --format=%h WORKING_DIRECTORY ${CMAKE_CURRENT_LIST_DIR} OUTPUT_VARIABLE TWAMP_GIT_COMMIT_ID OUTPUT_STRIP_TRAILING_WHITESPACE)
execute_process(COMMAND git describe --abbrev=7 --dirty --always --tags WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} OUTPUT_VARIABLE TWAMP_GIT_DESCRIBE OUTPUT_STRIP_TRAILING_WHITESPACE)
execute_process(COMMAND git describe --abbrev=7 --dirty --always --tags WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/qoo-c OUTPUT_VARIABLE QOO_GIT_DESCRIBE OUTPUT_STRIP_TRAILING_WHITESPACE)
execute_process(COMMAND git describe --abbrev=7 --dirty --always --tags WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/qoo-c/t-digest-c OUTPUT_VARIABLE TDIGEST_GIT_DESCRIBE OUTPUT_STRIP_TRAILING_WHITESPACE)

# message("VERSION_TXT is ${VERSION_TXT}")
# message("TWAMP_GIT_COMMIT_ID is ${TWAMP_GIT_COMMIT_ID}")
# message("TWAMP_GIT_DESCRIBE is ${TWAMP_GIT_DESCRIBE}")
# message("QOO_GIT_DESCRIBE is ${QOO_GIT_DESCRIBE}")
# message("TDIGEST_GIT_DESCRIBE is ${TDIGEST_GIT_DESCRIBE}")
add_definitions(-DTWAMP_VERSION_TXT=\"${VERSION_TXT}\")
add_definitions(-DTWAMP_GIT_COMMIT_ID=\"${TWAMP_GIT_COMMIT_ID}\")
add_definitions(-DTWAMP_GIT_DESCRIBE=\"${TWAMP_GIT_DESCRIBE}\")
add_definitions(-DQOO_GIT_DESCRIBE=\"${QOO_GIT_DESCRIBE}\")
add_definitions(-DTDIGEST_GIT_DESCRIBE=\"${TDIGEST_GIT_DESCRIBE}\")
